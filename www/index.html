<!DOCTYPE html>
<html>
	<head>
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<link rel="stylesheet" href="js/jquery/jquery.mobile-1.4.5.min.css">
	<script src="js/jquery/jquery-1.12.0.min.js"></script>
	<script src="js/jquery/jquery.mobile-1.4.5.min.js"></script>
	<script src="js/my.js"></script>
	<script>

		var months = [ 'января', 'февраля', 'марта', 'апреля', 'мая', 'июня', 'июля', 'августа', 'сентября', 'октября', 'ноября', 'декабря' ];

		function nowAsString()
		{
			var now = new Date();
			var h = sprintf( '%02d', now.getHours() );
			var m = sprintf( '%02d', now.getMinutes() );
			var s = sprintf( '%02d', now.getSeconds() );
			var d = sprintf( '%02d', now.getDate() );
			var M = months[ now.getMonth() ];
			var y = now.getFullYear();
			var dateArr = [ d, M, y ];
			var timeArr = [ h, m, s ];
			var date = '<b>' + dateArr.join(' ') + '</b>';
			var time = timeArr.join(':');
			return date + ' года ' + time;
		}

		var settings =
		{
			zp: 51500,
			workdayStart: 10,
			workdayFinish: 19
		};

		$(document).on('pagecreate',function(event)
		{
			$('#now').html( nowAsString() );

			$(window).on('orientationchange',function(event)
			{
				alert( 'Ты сменил ориентацию, муахаха. Теперь: ' + event.orientation );
			});
		});

		function countZP()
		{
			var now = new Date();
			if ( now.getHours() >= settings.workdayFinish )
			{
				now = new Date( now.getFullYear(), now.getMonth(), now.getDate(), settings.workdayFinish, 0, 0 );
			}
			var justNow = now.getTime();

			// начало рабочего дня в виде смещения в миллисекундах от 01.01.1970
			var now2 = new Date( 2016, 0, 30, settings.workdayStart, 0, 0 );
			var workdayStart = now2.getTime();

			// зп в секунду
			var zpInSec = settings.zp / 20 / ( settings.workdayFinish - settings.workdayStart + 1 ) / 60 / 60 / 1000;

			var zpToday = sprintf( '%.2f', zpInSec * ( justNow - workdayStart ) );

//			if( now.getDay() == 6 || now.getDay() == 7 ){ zpToday = 0; }

			return zpToday;
		}

		setInterval(function(){
			// выводим актуальное время
			$('#now').html( nowAsString() );
			// выводим зп
			$('#zp-today').html( countZP() );
		},100);

	</script>
</head>
<body>

<div data-role="page">

	<div data-role="header">
		<h1>Зарплатомер</h1>
	</div>

	<div data-role="main" class="ui-content">
		<p>
			Сейчас
			<span id="now"></span>
		</p>
		<p>
			Накапало сегодня:
			<b><span id="zp-today"></span></b> рублей
		</p>
		<p>
			Разбогател за текущий месяц на
			<b><span id="zp-month"></span></b> рублей
		</p>
	</div>

<!--
	<div data-role="footer">
		<h1>Footer Text</h1>
	</div>
-->

</div>

</body>
</html>
